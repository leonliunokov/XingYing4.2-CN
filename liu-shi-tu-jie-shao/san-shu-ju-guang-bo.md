# （三）数据广播

#### **SDK广播数据(6.3.1)**

1. 点击软件界面上方的“数据广播”，XINGYING软件默认网卡地址为“10.1.1.198”。也可在下拉框中更改IP地址。
2. XINGYING 软件支持 SDK 二次开发，可通过广播数据，在本机或其他同一个 IP 网段中的电脑使用。可在”网卡地址“中通过下拉框更改IP地址。设置的网卡地址为服务端数据发送的地址，若要接收来自动捕的数据，客户端电脑需要和服务段保持在同一网段
3. 软件支持动态获取IP功能，无需重启软件，可搭配C++/C# 等插件实时获取动捕数据，插件请咨询我们的技术工程师获取；
4.  SDK流：“使用 SDK”选项默认不勾选，使用此功能时可以在镜头未连接或暂停播放状态下勾选。勾选SDK后软件会保存此次配置，后续启动软件会默认勾选SDK。启用SDK后，动捕数据将通过设置的网卡IP地址以SDK协议向外广播发送数据。下方的”模式“软件支持“单播”和“组播”模式，默认设置为“组播”模式；\


    <figure><img src="../.gitbook/assets/image (375).png" alt=""><figcaption><p>6.3.1</p></figcaption></figure>
5. 勾选SDK选项后，实时模式下3D视图的左下角可实时显示出延迟时间和单位（6.3.2），关闭SDK功能则不会显示出延迟时间信息，在后处理模式中不会实时显示SDK延迟时间。
6. 骨骼坐标：骨骼坐标默认为“全局”（6.3.1），也可在下拉列表中设置“全局”或“局部”两种类型，设置骨骼坐标后会将此设置保存到配置中，在下次启动XINGYING时骨骼坐标会显示上一次设置的骨骼坐标类型
   * 全局：SDK向外发送的动捕数据以骨骼全局坐标的形式向外发送，客户端获取到的骨骼数据为全局骨骼坐标的数据；
   * 局部：SDK向外发送的动捕数据以骨骼局部坐标的形式向外发送，客户端获取到的骨骼数据为局部骨骼坐标的数据；
   * 若SDK发送的是刚体的数据，全局或局部两种类型向外广播发送的骨骼数据一致，无差别。若发送的数据为人体类型，全局或局部骨骼坐标向外广播发送的骨骼数据会存在一定差异；
   * 修改骨骼坐标类型需要将“SDK”关闭才可以进行修改，否则骨骼坐标功能为灰色无法修改。

![6.3.2](<../.gitbook/assets/5 (9).png>)



***

#### **VRPN广播数据(6.3.3)**

1. 开启VRPN前请先将软件暂停播放或在未连接镜头时在“数据广播”中启用VRPN，启用VRPN后，动捕数据将通过设置的网卡IP地址以VRPN协议向外广播发送数据。
2. VRPN可分为三种类型：”刚体、标记点、未命名标记点“。实时模式或后处理模式都可以使用VRPN传输数据；在使用VRPN之前您可以使用我们的“NokovVrpnClient.exe”测试工具来验证是否可以获取到VRPN数据，也可以使用开源的源码或工具来获取我们动捕里面的VRPN数据，下面简单介绍一下NokovVrpnClient测试工具获取不同类型的数据的方法（如需要该测试工具请咨询技术工程师获取）；
3.  勾选上”刚体”类型表示发出刚体的信息数据。在测试工具中命名方式为“刚体名称@10.1.1.198”。勾选上”刚体“并勾选上”启用VRPN“，勾选完成后点击播放使镜头处于播放状态。使用cmd命令在终端中进入NokovVrpnClient.exe文件所在的路径，输入命令”.\NokovVrpnClient.exe Tracker0@10.1.1.198“按下回车键（6.3.4），就可以获取到动捕中刚体的数据，其中“Tracker0”对应动捕软件中刚体的名称；\


    ![6.3.3](<../.gitbook/assets/6 (8).png>)

    ![6.3.4](<../.gitbook/assets/7 (6).png>)
4. 人体命名方式为Markerset名称\_骨骼名称，如：需要获取人体头部骨骼的信息，输入命令“.\NokovVrpnClient.exe Body0\_Head@10.1.1.198”按下回车，就可以获取到人体名称为Body0的头部骨骼数据了，“SHead”表示人体的头部骨骼名称，如果要获取人体的其他骨骼信息，只需要将“SHead”更换为对应的骨骼名称即可。
5.  ”标记点“类型表示发出有名称的Marker点信息数据。在测试工具中命名方式为“刚体名&#x79F0;_&#x4D;arker点名称@10.1.1.198”。勾选上”标记点“后勾选上”VRPN“，勾选完成后点击播放使镜头处于播放状态。使用cmd命令在终端中进入NokovVrpnClient.exe文件所在的路径，如：需要获取Tracker0这个刚体所属的“Marker1”这个点的数据，可以运行命令“.\NokovVrpnClient.ex&#x65;_&#x54;racker0\_Marker1@10.1.1.198“后按下回车（6.3.5），就可以获取到”Marker1”这个点的信息数据，其中“Tracker0”对应软件中刚体的名称，“Marker1”表示Tracker0这个刚体的所属点名称，刚体的点的具体名称可在资产--组成--标记列表中看到；\


    ![6.3.5](<../.gitbook/assets/8 (5).png>)
6.  “未命名标记点” 表示发出未命名的Marker点信息数据。其命名方式为“U\_Tracker+未命名Marker点索引(从0开始)@10.1.1.198”。勾选上”未命名标记点“并勾选上”VRPN“，勾选完成后点击播放使镜头处于播放状态。使用cmd命令在终端中进入NokovVrpnClient.exe文件所在的路径，输入命令”.\NokovVrpnClient.exe U\_Tracker0@10.1.1.198“按下回车（6.3.6），就可以获取到未命名的Marker点信息数据，其中“U\_Tarcker0”代表第一个未命名点，若要获取第二个未命名点的信息数据，则将“U\_Tarcker0”改成“U\_Tracker1”，代表第二个未命名点；\


    ![6.3.6](<../.gitbook/assets/9 (3).png>)
7. ”单位“选项框中代表不同单位，在选项框中可以更换数据的单位，分为“毫米”、“厘米”和“米”，将单位更换后，VRPN中的数据也会随着单位的变化而变大或减小；
8. 在“反转”中勾选x、y、z坐标表示把“类型”中勾选的变量正负号反转。“qx、qy、qz”表示刚体的旋转数据勾选，勾选“刚体”运行“.\NokovVrpnClient.exe Tracker0@10.1.1.198”后，“quat”可以显示出Tracker0这个刚体旋转的数据，勾选“qx、qy、qz”后会对“quat”的坐标值进行正负号反转（图 93），“quat”值只显示刚体的旋转，不显示变量“标记点、未命名标记点”的旋转信息
9. 在”偏移“中可以设置变量数据的“x、y、z”坐标偏移，修改好偏移的值后，在VRPN中会将修改的值加到原有的坐标值上；
10. ”速度“和”加速度“，勾选后VRPN中会输出相应数据。”帧因子“用于速度计算，可通过调节帧因子使实际速度值与输出的速度值接近。

#### 网络流

1. 兼容xsens mvn协议，可接入xsens mvn协议的软件应该都可使用，可将xingying数据通过haption软件发送到达兼容xsens mvn协议，可接入xsens mvn协议的软件应该都可使用，可将xingying数据通过haption软件发送到达索软件delmia和catia，驱动人体模型和道具，可发送数据到BOB软件，驱动人体模型；索软件delmia和catia，驱动人体模型和道具，可发送数据到BOB软件，驱动人体模型；
