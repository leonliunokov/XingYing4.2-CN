# （二）建立 MarkerSet(Rigid)

**创建模板**

* 点击资产下方的“创建资产”按钮，在弹出窗口中输入 MarkerSet 名称， 完成后点击“创建对象”（12.2.1），关闭窗口；

<figure><img src="../.gitbook/assets/image (519).png" alt=""><figcaption></figcaption></figure>



***

### **创建反光标记点**

* 点击软件界面右侧的 Markers 标签栏，在第一行双击空白部分输入反光标记点名称，回车以确认（12.2.2)，反复操作，将需要定义的反光标记点名称全部输入。也可通过回车快捷键在Markers 标签栏中快速创建Marker名称，如：需要创建五个Marker名称，在Markers标签栏选中第一行，快速按下回车键五次后，Markers标签栏中就会自动生成从Marker1\~Marker5的默认名称了；
* 注意在Markers标签栏中手动输入Markers名称时，请不要创建重复的Markers名称，在下文讲到的创建Link连线和Segment骨骼名称时，也不能输入重复的名称；

<figure><img src="../.gitbook/assets/6 (17).png" alt=""><figcaption><p>12.2.2</p></figcaption></figure>



***

### **定义Unamed Marker**

*   通过拖动时间轴，选择数据完整的帧（所捕物体上无丢失 Marker，无错点， 通常为数据的首帧），点击工具栏的快速识别按钮，会弹出窗口显示“定位Marker”，根据“定位Marker”所显示选中的 Marker名称，在 3D 视图中点击对应的点，进行匹配（12.2.3），匹配上的点会被自动分配颜色；\


    ![12.2.3](<../.gitbook/assets/7 (14).png>)
* 若匹配过程中有Marker 点错位置，可点击“Quick ID”窗口中的箭头，选到点错的 Marker名称，重新匹配，完成最后一个 Marker 的匹配后，“Quick ID”窗口将自动关闭；
*   勾选“Lock”锁定功能，开启该功能后，会将quick id值进行锁定不会自动增加（12.2.4）；\


    ![12.2.4](<../.gitbook/assets/8 (13).png>)
* 在匹配过程中，可通过按住键盘 Alt/Ctrl/Shift+鼠标左/右/滚轮键，变换 3D视图的角度位置，以确认各个点的实际位置；



***

### **创建Link连线**

1.  完成所有 Marker 匹配后，在组件中的“Links”标签栏点击“为模板创建连线”，在3D视图中鼠标左键选中一个点，拖动到下一个点上，Link连线创建完成，Links标签也中也会自动生成出此Link连线的名称（12.2.5）；\


    ![12.2.5](<../.gitbook/assets/9 (10).png>)
2. 创建并设置好所有Link连线后，3D 视图中可看到点和连线（12.2.6）；

![12.2.6](<../.gitbook/assets/10 (9).png>)



***

### **跟踪识别所有帧**

*   确保此时数据正处于首帧，点击跟踪识别按钮（12.2.7），将点和连线的定义应用至所有帧，此时可播放数据查看效果。至此Markerset已经创建完成；\


    <figure><img src="../.gitbook/assets/image (119).png" alt=""><figcaption><p>12.2.7</p></figcaption></figure>



***

### **建立骨骼（SKB类型）**

* 对于已经建立好 MarkerSet 并完成修复的数据，可以建立骨骼；SKB类型的骨骼需要由Markerset的 3 个 Marker 点来定义，这三个点分别用来定义刚体的原点（起点）、长轴点（终点）和 平面点，创建骨骼后可以得到刚体的欧拉角数据，常用于无人机、机械臂等应用场景；
*   在资产面板--组件--关节，双击空白部分输入关节（骨骼）名称（12.2.8）；\


    ![12.2.8](<../.gitbook/assets/12 (9).png>)
* 在下方的常规属性中双击“骨骼引擎”，在下拉菜单中选择“SKB”（12.2.9）；
*   选中创建的骨骼名称，在下方高级属性中定义骨骼的各项参数，在原点、长轴点、平面点中定义Marker，输入X、Y、Z轴旋转值后3D视图中该Markerset就会生成骨骼。\


    ![12.2.9](<../.gitbook/assets/13 (9).png>)



***

### **建立骨骼（Calcium）**

1. 创建骨骼的名称后在下方的常规属性中双击“骨骼引擎”，在下拉菜单中选择“Calcium”。Calcium类型的骨骼欧拉角旋转默认为ZYX，骨骼朝向和标定文件的朝向一致
2.  选中创建的骨骼名称，在下方高级属性中定义骨骼的各项参数。在3D视图中右键选择“Model Pose”，点击3D界面上方“坐标轴工具”，在弹出的窗口点击“平移”骨骼尾部会出现十字轴，拖动十字轴或者在“平移”后面的坐标值输入数值可以调节骨骼的位移；点击“旋转”骨骼尾部会出现旋转轴，拖动旋转轴或者在“旋转”后面的旋转值输入数值可以调节骨骼的旋转（12.2.10）。\


    <figure><img src="../.gitbook/assets/image (520).png" alt=""><figcaption></figcaption></figure>

在高级属性中双击“骨骼长度”，输入长度值后，3D视图中的骨骼长度会发生变化。

1.  绑定点数：在高级属性底部点击“绑定点数”，在资产--组件--标记列表中选取骨骼的关联点，选取完成后点击确认关闭窗口（12.2.11），选取的Marker点会和骨骼绑定。\


    <figure><img src="../.gitbook/assets/image (521).png" alt=""><figcaption></figcaption></figure>
2. 若用户在一个Markerset中创建了多段骨骼，请选择一段骨骼作为父骨骼，其余的骨骼也需要设置父骨骼。在高级属性中双击“父骨骼”来设置父段。
3. 骨骼的属性设置完毕后，在3D视图鼠标右键点击“Model Pose”退出，在Model Pose中编辑的骨骼属性不会立刻生效，需要将数据跳转到第一帧，点击软件上方工具栏的解算按钮，解算完成后，设置的属性生效。
4. 点击“文件 – 保存模型”，保存 MarkerSet。
5. 若需要将创建的此模板保存在动捕数据中，请点击“文件 – 保存动捕数据”。若未保存Markerset，直接切换到实时模式软件会弹窗提示用户是否保存cap文件，点击“是”，软件会将新建的Markerset模板连同修改的cap文件一同保存；
6. 若一组数据中有多个被捕捉物，可创建多个 Markerset，重复上述步骤即可；
